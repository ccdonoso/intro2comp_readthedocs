<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>6. Elasticidad Lineal en FEniCS 3D. &mdash; Introducción - Mecánica Computacional</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=92fd9be5" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=f2a433a1"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="5. Método de elementos finitos de Galerkin" href="fem_1d.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Intro2ComputationalMechanics
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Preliminares - Python.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="python_basics_solved.html">1. Introducción - Programación en Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy_solved.html">2. Programación Científica con Numpy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Métodos Numéricos.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="repaso_metodos_numericos.html">1. Repaso - Métodos Numéricos (1/2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="metodos_numericos_2.html">2. Métodos Numéricos (2/2)</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimizacion.html">3. Optimización</a></li>
<li class="toctree-l1"><a class="reference internal" href="mecanismos.html">4. Mecanismos</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Fundamentos de FEM.</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="metodo_rigidez.html">1. Método de la Rigidez</a></li>
<li class="toctree-l1"><a class="reference internal" href="oop_pyvista.html">2. Clases y PyVista</a></li>
<li class="toctree-l1"><a class="reference internal" href="mallas.html">3. Mallas</a></li>
<li class="toctree-l1"><a class="reference internal" href="metodo_residuos_ponderados.html">4. Método de residuos ponderados</a></li>
<li class="toctree-l1"><a class="reference internal" href="fem_1d.html">5. Método de elementos finitos de Galerkin</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Elasticidad Lineal en FEniCS 3D.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Las-ecuaciones-de-elasticidad-lineal.">6.1. Las ecuaciones de elasticidad lineal.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Problema-PDE">6.2. Problema PDE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Formulación-variacional.">6.3. Formulación variacional.</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Imponiendo-condiciones-de-borde">6.3.1. Imponiendo condiciones de borde</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Resumen-de-formulación-variacional">6.4. Resumen de formulación variacional</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Elasticidad-lineal-en-FENICS">6.5. Elasticidad lineal en FENICS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Importación-de-librerias:">6.5.1. Importación de librerias:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Creación-de-la-malla-y-espacio-vectorial-de-funciones.">6.5.2. Creación de la malla y espacio vectorial de funciones.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Definición-de-problema-variacional.">6.5.3. Definición de problema variacional.</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Definir-condiciones-de-contorno">6.5.4. Definir condiciones de contorno</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Resolver-el-problema-variacional">6.5.5. Resolver el problema variacional</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Postproceso-con-Pyvista.">6.6. Postproceso con Pyvista.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Esfuerzo-de-Von-Misses.">6.7. Esfuerzo de Von-Misses.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Nota-sobre-grad(u)-vs.-nabla_grad(u)">6.8. Nota sobre <code class="docutils literal notranslate"><span class="pre">grad(u)</span></code> vs. <code class="docutils literal notranslate"><span class="pre">nabla_grad(u)</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Elasticidad-anisótropa">6.8.1. Elasticidad anisótropa</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Intro2ComputationalMechanics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active"><span class="section-number">6. </span>Elasticidad Lineal en FEniCS 3D.</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/elasticity_3d.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Elasticidad-Lineal-en-FEniCS-3D.">
<h1><span class="section-number">6. </span>Elasticidad Lineal en FEniCS 3D.<a class="headerlink" href="#Elasticidad-Lineal-en-FEniCS-3D." title="Link to this heading"></a></h1>
<p><img alt="logo" class="no-scaled-link" src="https://github.com/ccdonoso/Intro2_Computational_Mechanics/blob/master/img/logo_usach_dimec.png?raw=true" style="width: 300px;" /></p>
<ul class="simple">
<li><p>Autor: Claudio Canales Donoso</p></li>
<li><p>Página: <a class="reference external" href="https://ccdonoso.github.io/">ccdonoso.github.io</a></p></li>
<li><p>Cursos: Mecánica Computacional - Diseño Computarizado</p></li>
<li><p>Universidad de Santiago de Chile</p></li>
<li><p>Fecha: 05/03/24</p></li>
</ul>
<p>License: BSD 3 clause</p>
<p><strong>Contenido</strong> - Elementos finitos 1. Ecuaciones de elasticidad lineal. 2. Formulación variacional. 3. Problema. 4. Resolución con FEniCS.</p>
<section id="Las-ecuaciones-de-elasticidad-lineal.">
<h2><span class="section-number">6.1. </span>Las ecuaciones de elasticidad lineal.<a class="headerlink" href="#Las-ecuaciones-de-elasticidad-lineal." title="Link to this heading"></a></h2>
<p>La elasticidad lineal es el estudio de cómo los objetos sólidos se deforman y se someten a tensiones internas debido a condiciones de carga prescritas.</p>
<p>Es un problema importante en la ingeniería moderna. Su correspondiente EDP es una generalización de la ecuación de Poisson, y es una de las EDP más populares en ingeniería.</p>
<p>Ahora estudiamos su formulación variacional y cómo resolver este problema utilizando FEniCS en 2D y 3D.</p>
</section>
<section id="Problema-PDE">
<h2><span class="section-number">6.2. </span>Problema PDE<a class="headerlink" href="#Problema-PDE" title="Link to this heading"></a></h2>
<p>La ecuación que rige las deformaciones elásticas de un cuerpo <span class="math notranslate nohighlight">\(\Omega\)</span> puede escribirse como</p>
<p><span class="math">\begin{equation}
\tag{1}
-\boldsymbol{\nabla}\cdot\boldsymbol{\sigma} = \boldsymbol{f}\hbox{ in }\Omega,
\end{equation}</span></p>
<p>donde <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> es el <em>tensor de tensiones</em>, y <span class="math notranslate nohighlight">\(\boldsymbol{f}\)</span> es la <em>fuerza del cuerpo por unidad de unidad</em>. Para materiales isótropos, el tensor de tensión se relaciona además con la deformación por las dos ecuaciones siguientes: <span class="math">\begin{align}
\boldsymbol{\sigma} &= \lambda\,\hbox{tr}\,(\boldsymbol{\varepsilon}) \boldsymbol{I} + 2\mu\boldsymbol{\varepsilon},
\tag{2}\\
\boldsymbol{\varepsilon} &= \frac{1}{2}\left(\boldsymbol{\nabla} \boldsymbol{u} + (\boldsymbol{\nabla} \boldsymbol{u})^{\top}\right),
\tag{3}
\end{align}</span> donde <span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}\)</span> es el <em>tensor de deformación simétrica</em> (gradiente simétrico), y <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span> es el <em>campo vectorial de desplazamiento</em>, <span class="math notranslate nohighlight">\(\boldsymbol{I}\)</span> denota el <em>tensor de identidad</em>, <span class="math notranslate nohighlight">\(\mathrm{tr}\)</span> denota el <em>operador traza</em> en un tensor, y <span class="math notranslate nohighlight">\(\lambda\)</span> y <span class="math notranslate nohighlight">\(\mu\)</span> son propiedades del material conocidas como <em>parámetros de elasticidad de Lamé</em>.</p>
<p>Combinamos las ecuaciones (2) y (3) para obtener: <span class="math">\begin{equation}
\tag{4}
\boldsymbol{\boldsymbol{\sigma}} = \lambda(\boldsymbol{\nabla}\cdot \boldsymbol{u})\boldsymbol{I} + \mu(\boldsymbol{\nabla} \boldsymbol{u} + (\boldsymbol{\nabla} \boldsymbol{u})^{\top})
\end{equation}</span></p>
<p>Tenga en cuenta que (1)–(3) pueden transformarse fácilmente en una EDP de un solo vector para <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span>, que es la para la incógnita <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span> (ecuación de Navier). En la En la derivación de la formulación variacional, sin embargo, es conveniente mantener las ecuaciones divididas como arriba.</p>
</section>
<section id="Formulación-variacional.">
<h2><span class="section-number">6.3. </span>Formulación variacional.<a class="headerlink" href="#Formulación-variacional." title="Link to this heading"></a></h2>
<p>La formulación variacional de (1)-(3) consiste en formar el producto interior de (1) y una función de prueba <em>vectorial</em> en <span class="math notranslate nohighlight">\(\hat{V}\)</span>, donde <span class="math notranslate nohighlight">\(\hat{V}\)</span> es un espacio de funciones vectoriales de prueba, e integrando sobre el dominio <span class="math notranslate nohighlight">\(\Omega\)</span>:</p>
<p><span class="math">\begin{equation} -\int_\Omega (\boldsymbol{\nabla}\cdot\boldsymbol{\sigma}) \cdot \boldsymbol{v}\ \mathrm{d}\boldsymbol{x} =
\int_\Omega \boldsymbol{f}\cdot \boldsymbol{v}\ \mathrm{d}\boldsymbol{x},\tag{5}
\end{equation}</span> where <span class="math notranslate nohighlight">\(\mathrm{d}\boldsymbol{x}\)</span> denotes the volume measure.</p>
<p>Dado que <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}\cdot\boldsymbol{\sigma}\)</span> contiene derivadas de segundo orden de la incógnita primaria desconocido <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span>, integramos este término por partes:</p>
<p><span class="math">\begin{equation}
-\int_\Omega (\boldsymbol{\nabla}\cdot\boldsymbol{\sigma}) \cdot \boldsymbol{v} \ \mathrm{d}\boldsymbol{x}
= \int_\Omega \boldsymbol{\sigma} : \boldsymbol{\nabla} \boldsymbol{v} \ \mathrm{d}\boldsymbol{x} - \int_{\partial\Omega}
(\boldsymbol{\sigma}\cdot \boldsymbol{n})\cdot \boldsymbol{v} \ \mathrm{d}\boldsymbol{s},
\tag{6}
\end{equation}</span></p>
<p>donde el operador dos puntos es el producto interior entre tensores (suma producto por pares de todos los elementos), <span class="math notranslate nohighlight">\(\boldsymbol{n}\)</span> es la normal unitaria exterior en el límite, y <span class="math notranslate nohighlight">\(\mathrm{d}\boldsymbol{s}\)</span> es una medida en superficie.</p>
<p>La cantidad <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\cdot \boldsymbol{n}\)</span> se conoce como la <em>tracción</em> o vector de tensión en la frontera, y a menudo se prescribe como condición de contorno en una parte <span class="math notranslate nohighlight">\(\partial_T\Omega\)</span> de la frontera como <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\cdot \boldsymbol{n} = \boldsymbol{T}\)</span>, mientras que el parte restante de la frontera tendría el valor de los desplazamientos prescritos.</p>
<p>Sustituyendo (6) en (5), obtenemos</p>
<p><span class="math">\begin{equation}
\int_\Omega \boldsymbol{\sigma} : \boldsymbol{\nabla} \boldsymbol{v}\ \mathrm{d}\boldsymbol{x} =
\int_\Omega \boldsymbol{f}\cdot \boldsymbol{v}\ \mathrm{d}\boldsymbol{x}
+ \int_{\partial\Omega} \boldsymbol{T}\cdot \boldsymbol{v}\ \mathrm{d}\boldsymbol{s}. \tag{7}
\end{equation}</span></p>
<p>Insertando la expresión (4) para se obtiene la forma variacional con <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span> como incógnita.</p>
<section id="Imponiendo-condiciones-de-borde">
<h3><span class="section-number">6.3.1. </span>Imponiendo condiciones de borde<a class="headerlink" href="#Imponiendo-condiciones-de-borde" title="Link to this heading"></a></h3>
<p>Veamos ahora cómo aplicar las condiciones de contorno. En el caso de los límites de Dirichlet, aplicaremos las condiciones de contorno de forma estricta. Para estos puntos, no se asocian funciones de prueba con los nodos Dirichlet.</p>
<p>Para las condiciones de contorno de tracción, haremos cumplir la condición de contorno débilmente utilizando la forma variacional (8). De forma similar a la ecuación de Poisson, requerimos sus correspondientes funciones de prueba <span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span> desaparecen a lo largo de <span class="math notranslate nohighlight">\(\partial \Omega\)</span> para los puntos interiores. Entonces, la integral de frontera anterior no tiene efectos para los puntos en <span class="math notranslate nohighlight">\(\partial\Omega\setminus\partial\Omega_T\)</span>.</p>
</section>
</section>
<section id="Resumen-de-formulación-variacional">
<h2><span class="section-number">6.4. </span>Resumen de formulación variacional<a class="headerlink" href="#Resumen-de-formulación-variacional" title="Link to this heading"></a></h2>
<p>En resumen, el problema variacional consiste en encontrar <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span> en un espacio vectorial de funciones <span class="math notranslate nohighlight">\(\hat{V}\)</span> tal que: <span class="math">\begin{equation}
a(\boldsymbol{u},\boldsymbol{v}) = L(\boldsymbol{v})\quad\forall \boldsymbol{v}\in\hat{V},\tag{10}
\end{equation}</span> donde <span class="math">\begin{align}
a(\boldsymbol{u},\boldsymbol{v}) &= \int_\Omega\sigma(\boldsymbol{u}) :\varepsilon(\boldsymbol{v})\ \mathrm{d}\boldsymbol{x},\tag{11}\\
L(\boldsymbol{v}) &= \int_\Omega \boldsymbol{f}\cdot \boldsymbol{v}\ \mathrm{d}\boldsymbol{x} + \int_{\partial\Omega_T} \boldsymbol{T}\cdot \boldsymbol{v}\ \mathrm{d}\boldsymbol{s}\tag{12},
\end{align}</span> y, <span class="math">\begin{equation}
\boldsymbol{\sigma}(\boldsymbol{u}) = \lambda(\boldsymbol{\nabla}\cdot \boldsymbol{u})\boldsymbol{I} + \mu(\boldsymbol{\nabla} \boldsymbol{u} + (\boldsymbol{\nabla} \boldsymbol{u})^{\top}).\tag{13}\\
\end{equation}</span></p>
</section>
<section id="Elasticidad-lineal-en-FENICS">
<h2><span class="section-number">6.5. </span>Elasticidad lineal en FENICS<a class="headerlink" href="#Elasticidad-lineal-en-FENICS" title="Link to this heading"></a></h2>
<p>Para demostrar la aplicación, modelaremos una viga empotrada que se deforma bajo su propio peso en 3D. Esto se puede modelar meidnate la fuerza de cuerpo (fuerza/volumen) como <span class="math notranslate nohighlight">\(\boldsymbol{f}=(0,0,-\rho g)\)</span> con <span class="math notranslate nohighlight">\(\rho\)</span> la densidad de la viga y <span class="math notranslate nohighlight">\(g\)</span> la aceleración de la gravedad. La viga tiene es de sección cuadrada con una longitud <span class="math notranslate nohighlight">\(L\)</span> y una sección transversal cuadrada de anchura <span class="math notranslate nohighlight">\(W\)</span>. Establecemos <span class="math notranslate nohighlight">\(\boldsymbol{u}=(0,0,0)\)</span> en el extremo empotrado, <span class="math notranslate nohighlight">\(x=0\)</span>.
El resto de la frontera es libre de tracción, es decir, fijamos <span class="math notranslate nohighlight">\(\boldsymbol{T} = 0\)</span>. Por tanto,</p>
<div class="math notranslate nohighlight">
\[L(\boldsymbol{v}) = \int_\Omega \boldsymbol{f}\cdot \boldsymbol{v} \mathrm{d}\boldsymbol{x}\]</div>
<p>para este problema.</p>
<p><img alt="1052bef039064f5d87d96db6a8115929" class="no-scaled-link" src="https://fenicsproject.org/pub/tutorial/html/fig/elasticity.png" style="width: 400px;" /></p>
<section id="Importación-de-librerias:">
<h3><span class="section-number">6.5.1. </span>Importación de librerias:<a class="headerlink" href="#Importación-de-librerias:" title="Link to this heading"></a></h3>
<p><strong>Este código esta implementado para que pueda ser ejecutado en Google Colab. Esto facilitara la instalación de Fenics.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">dolfin</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="err">!</span><span class="n">wget</span> <span class="s2">&quot;https://fem-on-colab.github.io/releases/fenics-install-real.sh&quot;</span> <span class="o">-</span><span class="n">O</span> <span class="s2">&quot;/tmp/fenics-install.sh&quot;</span> <span class="o">&amp;&amp;</span> <span class="n">bash</span> <span class="s2">&quot;/tmp/fenics-install.sh&quot;</span>
    <span class="kn">import</span> <span class="nn">dolfin</span>


<span class="c1"># setup enviornment for interactive plotting</span>
<span class="err">!</span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="o">-</span><span class="n">qq</span> <span class="n">xvfb</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyvista</span> <span class="n">panel</span> <span class="o">-</span><span class="n">q</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;/usr/bin/Xvfb :99 -screen 0 1024x768x24 &amp;&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;DISPLAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;:99&#39;</span>

<span class="kn">import</span> <span class="nn">panel</span> <span class="k">as</span> <span class="nn">pn</span>
<span class="n">pn</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s1">&#39;vtk&#39;</span><span class="p">)</span>

<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">pyvista</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">vtk</span>

<span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
<span class="err">!</span><span class="n">pip</span> <span class="n">install</span> <span class="n">trame</span>
</pre></div>
</div>
</div>
</section>
<section id="Creación-de-la-malla-y-espacio-vectorial-de-funciones.">
<h3><span class="section-number">6.5.2. </span>Creación de la malla y espacio vectorial de funciones.<a class="headerlink" href="#Creación-de-la-malla-y-espacio-vectorial-de-funciones." title="Link to this heading"></a></h3>
<p>Comenzamos definendo y creando la malla con Fenics. Además, se define el espacio vectorial de funciones del problema.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scaled variables</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">W</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">W</span><span class="o">/</span><span class="n">L</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="n">beta</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">gamma</span>

<span class="c1"># Create mesh and define function space</span>
<span class="n">mesh</span> <span class="o">=</span> <span class="n">BoxMesh</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">W</span><span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">VectorFunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Definición-de-problema-variacional.">
<h3><span class="section-number">6.5.3. </span>Definición de problema variacional.<a class="headerlink" href="#Definición-de-problema-variacional." title="Link to this heading"></a></h3>
<p>La incógnita principal es ahora un campo vectorial <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span> y no un campo escalar, así que tenemos que trabajar con un espacio de función vectorial. Vamos a utilizar funciones por partes para todos los componentes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">TrialFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">TestFunction</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Con <code class="docutils literal notranslate"><span class="pre">u</span> <span class="pre">=</span> <span class="pre">TrialFunction(V)</span></code> tenemos que <code class="docutils literal notranslate"><span class="pre">u</span></code> como un elemento finito vector-valued con tres componentes para este problema 3D.</p>
<p>A continuación definimos el tensor de tensiones y <span class="math notranslate nohighlight">\(a\)</span>. Los operadores de gradiente y divergencia tienen ahora un prefijo <code class="docutils literal notranslate"><span class="pre">nabla_</span></code>. Esto no es estrictamente necesario en el presente problema, pero es recomendado en general para las EDP vectoriales que surgen de la mecánica del continuo, si se interpreta <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}\)</span> como un vector en la notación de la EDP. Véase las notas sobre <code class="docutils literal notranslate"><span class="pre">grad(u)</span></code> vs. <code class="docutils literal notranslate"><span class="pre">nabla_grad(u)</span></code> a continuación.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># define stress and strain.</span>
<span class="k">def</span> <span class="nf">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">nabla_grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">+</span> <span class="n">nabla_grad</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="c1">#return sym(nabla_grad(u))</span>

<span class="n">beta</span> <span class="o">=</span> <span class="mf">1.25</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="n">beta</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">geometric_dimension</span><span class="p">()</span>  <span class="c1"># space dimension</span>

<span class="k">def</span> <span class="nf">sigma</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">lambda_</span><span class="o">*</span><span class="n">nabla_div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">*</span><span class="n">Identity</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">mu</span><span class="o">*</span><span class="n">epsilon</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

<span class="c1"># Define a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">inner</span><span class="p">(</span><span class="n">sigma</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">epsilon</span><span class="p">(</span><span class="n">v</span><span class="p">))</span><span class="o">*</span><span class="n">dx</span>
</pre></div>
</div>
</div>
<p>Para definir <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{f}=(0, 0, \rho*g)\)</span> es una constante vectorial, en lugar de un escalar. Tal constante vectorial se especifica como <code class="docutils literal notranslate"><span class="pre">Constant(0,</span> <span class="pre">0,</span> <span class="pre">-rho*g)</span></code> en FEniCS.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define L</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">delta</span> <span class="o">=</span> <span class="n">W</span><span class="o">/</span><span class="n">L</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.4</span><span class="o">*</span><span class="n">delta</span><span class="o">**</span><span class="mi">2</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">gamma</span>

<span class="c1">#T = Constant((0,0,0))</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">rho</span><span class="o">*</span><span class="n">g</span><span class="p">))</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">dot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span><span class="o">*</span><span class="n">dx</span> <span class="c1"># + dot(T, v)*ds</span>
</pre></div>
</div>
</div>
</section>
<section id="Definir-condiciones-de-contorno">
<h3><span class="section-number">6.5.4. </span>Definir condiciones de contorno<a class="headerlink" href="#Definir-condiciones-de-contorno" title="Link to this heading"></a></h3>
<p>Sólo especificamos la condición de contorno Dirichlet. Para la condición de contorno <span class="math notranslate nohighlight">\(u=(0, 0, 0)\)</span>, debemos poner un valor vectorial a cero, no sólo un escalar. Especificamos la constante vectorial como <code class="docutils literal notranslate"><span class="pre">Constant((0,</span> <span class="pre">0,</span> <span class="pre">0))</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tol</span> <span class="o">=</span> <span class="mf">1E-14</span>

<span class="k">def</span> <span class="nf">clamped_boundary</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">on_boundary</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">on_boundary</span> <span class="ow">and</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">tol</span>

<span class="n">bc</span> <span class="o">=</span> <span class="n">DirichletBC</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">Constant</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span> <span class="n">clamped_boundary</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Resolver-el-problema-variacional">
<h3><span class="section-number">6.5.5. </span>Resolver el problema variacional<a class="headerlink" href="#Resolver-el-problema-variacional" title="Link to this heading"></a></h3>
<p>Por último, podemos resolver el problema.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute solution</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="n">solve</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="n">L</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">bc</span><span class="p">)</span>

<span class="n">vtkfile</span> <span class="o">=</span> <span class="n">File</span><span class="p">(</span><span class="s1">&#39;elasticity/solutions.pvd&#39;</span><span class="p">)</span>
<span class="n">vtkfile</span> <span class="o">&lt;&lt;</span> <span class="n">u</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Postproceso-con-Pyvista.">
<h2><span class="section-number">6.6. </span>Postproceso con Pyvista.<a class="headerlink" href="#Postproceso-con-Pyvista." title="Link to this heading"></a></h2>
<p>Para postprocesar los resultados. Comenzaremos ploteando el campo de desplazamiento en PyVista. También, se presentará la malla del campo deformado.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Color de mapa de colores</span>
<span class="n">pv</span><span class="o">.</span><span class="n">global_theme</span><span class="o">.</span><span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;jet&#39;</span>
<span class="n">pn</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s1">&#39;vtk&#39;</span><span class="p">)</span>


<span class="c1"># Extracción de campo de interes para plottear en pyvista.</span>
<span class="n">u_field</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">coordinates</span><span class="p">():</span>
    <span class="n">u_field</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="n">u_field</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">u_field</span><span class="p">)</span>


<span class="c1"># Carga la malla. Esto no considera los campos como desplazamiento.</span>
<span class="n">meshpv</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;elasticity/solutions.pvd&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Se agrega la información a cada punto de la malla con la información del campo</span>
<span class="c1"># de desplazamiento.</span>
<span class="n">meshpv</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s2">&quot;Displacement Field&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">u_field</span>

<span class="c1"># Se deforma la malla, de acuerdo a un factor de 1 de la solución.</span>
<span class="n">meshpv</span> <span class="o">=</span> <span class="n">meshpv</span><span class="o">.</span><span class="n">warp_by_vector</span><span class="p">(</span><span class="s2">&quot;Displacement Field&quot;</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Plotter.</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">meshpv</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="s2">&quot;Deflexión de viga&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;
(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.3.4'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var reloading = false;
  var Bokeh = root.Bokeh;

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'vtk': 'https://cdn.jsdelivr.net/npm/vtk.js@20.0.1/vtk', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'vtk': {'exports': 'vtk'}, 'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["vtk"], function() {
    on_load()
      })
      require(["jspanel"], function(jsPanel) {
    window.jsPanel = jsPanel
    on_load()
      })
      require(["jspanel-modal"], function() {
    on_load()
      })
      require(["jspanel-tooltip"], function() {
    on_load()
      })
      require(["jspanel-hint"], function() {
    on_load()
      })
      require(["jspanel-layout"], function() {
    on_load()
      })
      require(["jspanel-contextmenu"], function() {
    on_load()
      })
      require(["jspanel-dock"], function() {
    on_load()
      })
      require(["gridstack"], function(GridStack) {
    window.GridStack = GridStack
    on_load()
      })
      require(["notyf"], function() {
    on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
    existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
    on_load()
    continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['vtk'] !== undefined) && (!(window['vtk'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.3.8/dist/bundled/abstractvtkplot/vtk.js@20.0.1/vtk.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.3.8/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.3.8/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.3.8/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.3.8/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.3.8/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.3.8/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.3.8/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.3.8/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.3.8/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
    existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
    if (!window.requirejs) {
      on_load();
    }
    continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
    if (!window.requirejs) {
      on_load();
    }
    continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
    if (!window.requirejs) {
      on_load();
    }
    continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.3.8/dist/bundled/abstractvtkplot/vtk.js@20.0.1/vtk.js", "https://cdn.bokeh.org/bokeh/release/bokeh-3.3.4.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.3.4.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.3.4.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.3.4.min.js", "https://cdn.holoviz.org/panel/1.3.8/dist/panel.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
    try {
          inline_js[i].call(root, root.Bokeh);
    } catch(e) {
      if (!reloading) {
        throw e;
      }
    }
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
    var NewBokeh = root.Bokeh;
    if (Bokeh.versions === undefined) {
      Bokeh.versions = new Map();
    }
    if (NewBokeh.version !== Bokeh.version) {
      Bokeh.versions.set(NewBokeh.version, NewBokeh)
    }
    root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      if (!reloading && !bokeh_loaded) {
    root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
    console.debug("Bokeh: BokehJS plotting callback run at", now());
    run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));
</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;

if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        })
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();



var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}

</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div id='a3a5b1cb-ee8a-4e19-9da7-75a427edb790'>
  <div id="ae9c3caa-456c-406a-9cd2-29b35d034de6" data-root-id="a3a5b1cb-ee8a-4e19-9da7-75a427edb790" style="display: contents;"></div>
</div>
<script type="application/javascript">(function(root) {
  var docs_json = {"9bd46eb2-7c9b-47aa-bc46-58ab4c4e5f59":{"version":"3.3.4","title":"Bokeh Application","roots":[{"type":"object","name":"panel.models.browser.BrowserInfo","id":"a3a5b1cb-ee8a-4e19-9da7-75a427edb790"},{"type":"object","name":"panel.models.comm_manager.CommManager","id":"39a6e7c9-8512-41b9-825b-2fc882b996f2","attributes":{"plot_id":"a3a5b1cb-ee8a-4e19-9da7-75a427edb790","comm_id":"c83075b71dfc4cc2bcd7a36cf5413f35","client_comm_id":"975c66adcf5945faae01d9f615c9da73"}}],"defs":[{"type":"model","name":"ReactiveHTML1"},{"type":"model","name":"FlexBox1","properties":[{"name":"align_content","kind":"Any","default":"flex-start"},{"name":"align_items","kind":"Any","default":"flex-start"},{"name":"flex_direction","kind":"Any","default":"row"},{"name":"flex_wrap","kind":"Any","default":"wrap"},{"name":"justify_content","kind":"Any","default":"flex-start"}]},{"type":"model","name":"FloatPanel1","properties":[{"name":"config","kind":"Any","default":{"type":"map"}},{"name":"contained","kind":"Any","default":true},{"name":"position","kind":"Any","default":"right-top"},{"name":"offsetx","kind":"Any","default":null},{"name":"offsety","kind":"Any","default":null},{"name":"theme","kind":"Any","default":"primary"},{"name":"status","kind":"Any","default":"normalized"}]},{"type":"model","name":"GridStack1","properties":[{"name":"mode","kind":"Any","default":"warn"},{"name":"ncols","kind":"Any","default":null},{"name":"nrows","kind":"Any","default":null},{"name":"allow_resize","kind":"Any","default":true},{"name":"allow_drag","kind":"Any","default":true},{"name":"state","kind":"Any","default":[]}]},{"type":"model","name":"drag1","properties":[{"name":"slider_width","kind":"Any","default":5},{"name":"slider_color","kind":"Any","default":"black"},{"name":"value","kind":"Any","default":50}]},{"type":"model","name":"click1","properties":[{"name":"terminal_output","kind":"Any","default":""},{"name":"debug_name","kind":"Any","default":""},{"name":"clears","kind":"Any","default":0}]},{"type":"model","name":"copy_to_clipboard1","properties":[{"name":"fill","kind":"Any","default":"none"},{"name":"value","kind":"Any","default":null}]},{"type":"model","name":"FastWrapper1","properties":[{"name":"object","kind":"Any","default":null},{"name":"style","kind":"Any","default":null}]},{"type":"model","name":"NotificationAreaBase1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0}]},{"type":"model","name":"NotificationArea1","properties":[{"name":"js_events","kind":"Any","default":{"type":"map"}},{"name":"notifications","kind":"Any","default":[]},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0},{"name":"types","kind":"Any","default":[{"type":"map","entries":[["type","warning"],["background","#ffc107"],["icon",{"type":"map","entries":[["className","fas fa-exclamation-triangle"],["tagName","i"],["color","white"]]}]]},{"type":"map","entries":[["type","info"],["background","#007bff"],["icon",{"type":"map","entries":[["className","fas fa-info-circle"],["tagName","i"],["color","white"]]}]]}]}]},{"type":"model","name":"Notification","properties":[{"name":"background","kind":"Any","default":null},{"name":"duration","kind":"Any","default":3000},{"name":"icon","kind":"Any","default":null},{"name":"message","kind":"Any","default":""},{"name":"notification_type","kind":"Any","default":null},{"name":"_destroyed","kind":"Any","default":false}]},{"type":"model","name":"TemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"BootstrapTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"MaterialTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]}]}};
  var render_items = [{"docid":"9bd46eb2-7c9b-47aa-bc46-58ab4c4e5f59","roots":{"a3a5b1cb-ee8a-4e19-9da7-75a427edb790":"ae9c3caa-456c-406a-9cd2-29b35d034de6"},"root_ids":["a3a5b1cb-ee8a-4e19-9da7-75a427edb790"]}];
  var docs = Object.values(docs_json)
  if (!docs) {
    return
  }
  const py_version = docs[0].version.replace('rc', '-rc.').replace('.dev', '-dev.')
  function embed_document(root) {
    var Bokeh = get_bokeh(root)
    Bokeh.embed.embed_items_notebook(docs_json, render_items);
    for (const render_item of render_items) {
      for (const root_id of render_item.root_ids) {
    const id_el = document.getElementById(root_id)
    if (id_el.children.length && (id_el.children[0].className === 'bk-root')) {
      const root_el = id_el.children[0]
      root_el.id = root_el.id + '-rendered'
    }
      }
    }
  }
  function get_bokeh(root) {
    if (root.Bokeh === undefined) {
      return null
    } else if (root.Bokeh.version !== py_version) {
      if (root.Bokeh.versions === undefined || !root.Bokeh.versions.has(py_version)) {
    return null
      }
      return root.Bokeh.versions.get(py_version);
    } else if (root.Bokeh.version === py_version) {
      return root.Bokeh
    }
    return null
  }
  function is_loaded(root) {
    var Bokeh = get_bokeh(root)
    return (Bokeh != null && Bokeh.Panel !== undefined && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined) && ( root['vtk'] !== undefined))
  }
  if (is_loaded(root)) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (is_loaded(root)) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
      var Bokeh = get_bokeh(root)
      if (Bokeh == null || Bokeh.Panel == null) {
            console.warn("Panel: ERROR: Unable to run Panel code because Bokeh or Panel library is missing");
      } else {
        console.warn("Panel: WARNING: Attempting to render but not all required libraries could be resolved.")
        embed_document(root)
      }
        }
      }
    }, 25, root)
  }
})(window);</script></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.10/dist-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend:

cannot import name &#39;vtk&#39; from &#39;trame.widgets&#39; (/usr/local/lib/python3.10/dist-packages/trame/widgets/__init__.py)

Falling back to a static output.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elasticity_3d_22_5.png" src="../_images/notebooks_elasticity_3d_22_5.png" />
</div>
</div>
</section>
<section id="Esfuerzo-de-Von-Misses.">
<h2><span class="section-number">6.7. </span>Esfuerzo de Von-Misses.<a class="headerlink" href="#Esfuerzo-de-Von-Misses." title="Link to this heading"></a></h2>
<p>Calcularemos el esfuerzo de Von-Misses definido como:</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\sigma}_M = \sqrt{\frac{3}{2}\boldsymbol{s}:\boldsymbol{s}},\]</div>
<p>donde <span class="math notranslate nohighlight">\(\boldsymbol{s}\)</span> es el tensor desviatorico de esfuerzo.</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{s} = \boldsymbol{\sigma} - \frac{1}{3}\mathrm{tr}\,(\boldsymbol{\sigma})\,\boldsymbol{I}.\]</div>
<p>Existe una correspondencia uno a uno entre estas fórmulas y el código FEniCS, donde calculamos la variable <code class="docutils literal notranslate"><span class="pre">von_Mises</span></code> proyectándola al espacio de elementos finitos.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculo de esfuerzo de Von-Misses en Fenics.</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">tr</span><span class="p">(</span><span class="n">sigma</span><span class="p">(</span><span class="n">u</span><span class="p">))</span><span class="o">*</span><span class="n">Identity</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># deviatoric stress</span>
<span class="n">von_Mises</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mf">3.</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">inner</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">FunctionSpace</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">von_Mises</span> <span class="o">=</span> <span class="n">project</span><span class="p">(</span><span class="n">von_Mises</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>

<span class="c1"># Plotteo de von_Mises en PyVista.</span>
<span class="n">von_ms</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">coordinates</span><span class="p">():</span>
    <span class="n">von_ms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">von_Mises</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
<span class="n">von_ms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">von_ms</span><span class="p">)</span>

<span class="c1"># Se agrega la información a cada punto de la malla con la información del campo</span>
<span class="c1"># (Esfuerzo de Von-Misses)</span>
<span class="n">meshpv</span><span class="o">.</span><span class="n">point_data</span><span class="p">[</span><span class="s2">&quot;Esfuerzo de Von-Misses&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">von_ms</span>

<span class="c1"># Plotter.</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">Plotter</span><span class="p">(</span><span class="n">notebook</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">meshpv</span><span class="p">,</span> <span class="n">scalars</span><span class="o">=</span><span class="s2">&quot;Esfuerzo de Von-Misses&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_title</span><span class="p">(</span><span class="s2">&quot;Esfuerzo de Von Misses&quot;</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.10/dist-packages/pyvista/jupyter/notebook.py:34: UserWarning: Failed to use notebook backend:

cannot import name &#39;vtk&#39; from &#39;trame.widgets&#39; (/usr/local/lib/python3.10/dist-packages/trame/widgets/__init__.py)

Falling back to a static output.
  warnings.warn(
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_elasticity_3d_24_1.png" src="../_images/notebooks_elasticity_3d_24_1.png" />
</div>
</div>
</section>
<section id="Nota-sobre-grad(u)-vs.-nabla_grad(u)">
<h2><span class="section-number">6.8. </span>Nota sobre <code class="docutils literal notranslate"><span class="pre">grad(u)</span></code> vs. <code class="docutils literal notranslate"><span class="pre">nabla_grad(u)</span></code><a class="headerlink" href="#Nota-sobre-grad(u)-vs.-nabla_grad(u)" title="Link to this heading"></a></h2>
<p>Para funciones escalares, <span class="math notranslate nohighlight">\(\boldsymbol{\nabla} u\)</span> tiene un significado claro como el vector</p>
<div class="math notranslate nohighlight">
\[\boldsymbol{\nabla} u =\left(\frac{\partial u}{\partial x}, \frac{\partial u}{\partial y},
\frac{\partial u}{\partial z}\right).\]</div>
<p>Sin embargo, para una función vectorial <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span>, el significado es menos claro. Algunas fuentes definen <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}\boldsymbol{u}\)</span> como la matriz con elementos <span class="math notranslate nohighlight">\(\partial u_j / \partial x_i\)</span>, especialmente en mecánica continua. Algunas otras fuentes prefieren <span class="math notranslate nohighlight">\(\partial u_i / \partial x_j\)</span>, como en la <em>matriz jacobiana</em>.</p>
<p>En nuestras notas, <span class="math notranslate nohighlight">\(\boldsymbol{\nabla}\)</span> siempre denota la matriz con elementos <span class="math notranslate nohighlight">\(\partial u_j / \partial x_i\)</span>, para ser consistentes con la mayoría de las EDP. El operador correspondiente en FEniCS es <code class="docutils literal notranslate"><span class="pre">nabla_grad(u)</span></code>. Para la matriz Jacobiana, su operador correspondiente en FEniCS es <code class="docutils literal notranslate"><span class="pre">grad(u)</span></code>.</p>
<section id="Elasticidad-anisótropa">
<h3><span class="section-number">6.8.1. </span>Elasticidad anisótropa<a class="headerlink" href="#Elasticidad-anisótropa" title="Link to this heading"></a></h3>
<p>Podemos permitir fácilmente materiales anisotrópicos ya que (9) es simplemente el producto interior de el tensor de tensión y el tensor de deformación. La elasticidad anisotrópica es más fácil de tratar teniendo un vector 6 con los componentes únicos de tensión y deformación y relacionar los 6 vectores a través de un <span class="math notranslate nohighlight">\(6\times 6\)</span> elasticidad <span class="math notranslate nohighlight">\(\boldsymbol{D}\)</span>: <span class="math notranslate nohighlight">\(\boldsymbol{\sigma} = \boldsymbol{D}\boldsymbol{\varepsilon}\)</span>. Formamos entonces el producto interior de
<span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> y <span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}\)</span> para ser <span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}^T \boldsymbol{D}\boldsymbol{\varepsilon}\)</span>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="fem_1d.html" class="btn btn-neutral float-left" title="5. Método de elementos finitos de Galerkin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Claudio Canales D..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>